## 인공지능 _ 최유경 교수님

### 강의 4. 

* 인공지능을 위한 응용수학 : 선형대수, 확률통계, 수치해석

**https://www.deeplearningbook.org/**

위 링크에 들어가면 딥러닝을 위한 수학( 선형대수, 확률통계, 수치해석)을 공부할수있다.

* 인공지능 분야에서는 상황을 판단하는 하나의 방법으로 정답이 될 확률이 가장 높은 것을 정답으로 채택하는 방법을 자주 사용한다.
* 확률

$$
확률 \ = \frac{어떤\ 사건이\ 발생할\ 수\ 있는\ 경우의\ 가짓\ 수}{모든 \ 경우의\ 가짓수}
$$

```
예) 주사위의 1이 나올 경우의 수를 구하시오.
주사위를 던져 나오는 모든 경우의 수 : 1,2,3,4,5,6 총 6가지
주사위 1이 나오 경우의 수 : 1가지
주사위를 던졌을 때 1이 나올 확률 = 1/6
```

* 확률변수(Random Variable)
  * 정의역이 표본공간, 공역이 실수 전체의 집합인 '함수'
  * 그러나 변수의 역할을 하므로 확률 변수라고 한다.
  * 한 개의 동전을 두 번 던지는 시행에서 앞면이 나오는 횟수를 확률변수 $$X$$ 라고 하자. 
  * $$X=f(S)$$ $$x$$ 는 동전 두 개를 던져 앞면이 나오는 모든 경우의 수 $$(S_i)$$ 를 구하는 '함수' 이다.
* 이산확률변수(Discrete Random Variable)
  * 확률변수 X가 가지는 값이 유한개이거나 자연수와 같이 셀 수 있을 때, X를 이산확률변수라고 한다.
* 연속확률변수(Continuous Random Variable)
  * 확률변수 X가 가지는 값이 무한개여서 셀 수 없을 때, X를 연속확률변수라고 한다.
  * ex) 키, 몸무게, 넓이
  * 어떤 사건의 연속확률변수가 x일 때, 그에 대한 확률 P는 연속확률분포 $$f(x)$$ 를 지정한 $$X$$ 의 구간 안에서 적분한 것과 같다. 

$$
P(a\le X\le b) = \int_{a}^{b} f(x)\, dx
$$



* 확률 분포(Probability Distribution)

  * 정의역이 확률 변수, 공역이 확률의 집합인 '함수'
  * 앞면을 H, 뒷면을 T라 하면 표본 공간 S는 S={HH, HT, TH, TT} 이므로, 이산확률변수 X가 취할 수 있는 값은 0,1,2 이고, 각 값을 취할 확률은 1/4, 1/2, 1/4 이다.
  * 즉, P(X=0) = 1/4, P(X=1) = 1/2, P(X=2) = 1/4
  * $$P=g(X)$$ $$P$$ 는 동전 두 개 중 앞면이 $$x_i$$ 개 나올 확률 분포 함수이다.
  * Histogram 표현 := 확률분포표

* 확률함수

  * 확률 질량 함수(Probability Mass Function)
    * 이산 확률 분포의 확률 함수
  * 확률 밀도 함수(Probability Density Function)
    * 연속 확률 분포의 확률 함수

* 결합확률과 조건부확률 (Joint Probability & Conditional Probability)

  * 결합확률의 정의
    * 사건 A와 사건 B가 서로 독립된 사건일 때, 두 사건의 결합 확률은 다음과 같다.

  $$
  P(A\cap B)=P(A,B)=P(A)P(B)
  $$

  

  * 조건부확률의 정의
    * 사건 B가 일어났을 때, 사건 A가 일어날 조건부 확률을 다음과 같다.

  $$
  P(A|B)=\frac{P(A\cap B)}{P(B)}=\frac{P(A,B)}{P(B)}
  $$

  * 문제 1.

  ```
  하나의 주사위를 두 번 던진다고 가정하자.
  사건 A는 주사위를 두번 던져서 나온 숫자의 합이 8이상일 사건이고, 사건 B는 첫번째 주사위를 던졌을 때 나오는 숫자가 5가 되는 사건 이라고 할때, 결합확률P(A,B)와 조건부확률 P(A|B)를 구하시오.
  ```

  * 정답

  ```
  결합확률 P(A,B)를 구해보자. P(A,B)는 첫 주사위를 던졌을 때 5가 나오고, 두 번째 주사위를 던졌을 때, 3이상의 수가 나올 확률을 의미한다. 1/6 * 4/6 = 1/9 가 된다. 다음은 조건부 확률 P(A|B)를 구해보자. P(B)는 첫번째 주사위를 던졌을 때, 5가 나오는 사건이므로 확률은 1/6이 된다. 조건부 확률 정의 P(A|B) = P(A,B)/P(B) 에 따르면, 1/9 / 1/6 = 2/3 이 되어 P(A|B)의 확률은 2/3이 된다. 
  ```

  * 문제2. 

  ```
  백만 명에 다섯 명 꼴로 어떤 질병에 걸린다고 가정하자. 이 질병을 진단하는데 최신 AI 기술을 사용하면, 99.99%의 정밀도로 그 사람이 질병에 걸렸는지 안 걸렸는지를 판정할 수 있다. (0.01%확률로 잘못된 판정을 할 수 있음) 최수정씨는 시험삼아 최신 AI 검사를 받았다. 진단 결과가 양성으로 나왔다면 실제로 최수정씨가 이 질병에 걸렸을 확률은 얼마일까요?
  
  ```

  * 정답(맞나?)

  ```
  사건 A: 질병에 걸릴 사건
  사건 B: 진단 결과가 양성으로 나올 사건
  P(A,B) = P(A)P(B) = 0.00005 * 0.9999
  P(A|B) = P(A,B)/P(B) = 0.00005 * 0.9999 / 0.9999 = 0.00005
  ```

* 사슬법칙(Chain rule)

  * 조건부확률과 결합확률의 관계를 확장하면 복수의 사건 X1,X2,...,XN 에 대한 조건부 확률을 다음처럼 쓸 수있다. 이를 사슬법칙(chain rule)이라고 한다.

  $$
  P(X_1,X_2) = P(X_1)P(X_2|X_1) \\
  P(X_1,X_2,X_3) = P(X_3|X_1,X_2)P(X_1,X_2) \\
  =P(X_1)P(X_2|X_1)P(X_3|X_1,X_2) \\
  P(X_1,X_2,X_3,X_4) = P(X_4|X_1,X_2,X_3)P(X_1,X_2,X_3) \\
  =P(X_1)P(X_2|X_1)P(X_3|X_1,X_2)P(X_4|X_1,X_2,X_3)
  $$



* 기댓값(Expectation Value)

  * 나올 것이라고 예상하는 값
  * X가 확률변수이고 확률 P(X)인 사건이 벌어질 때, 예상할 수 있는 결괏값이 기대 값임
  * 모든 이산확률변수 X에 대한 기댓 값 E(X)는 다음과 같다. (이 때, 확률은 P(X))

  $$
  E(X) = \sum P(X) \cdot X
  $$

* 기댓값의 속성(Properties of Expectation Value)

  * $$E(k) = k $$ (상수의 기댓값은 상수가 된다.)
  * $$E(kX) = kE(X)$$ (확률변수를 상수 배하면, 기댓값도 상수 배가 된다)
  * $$E(X+Y) = E(X) + E(Y)$$ (확률변수의 합의 기댓값은 각 기댓값의 합과 같다)
  * $$X$$ 와 $$Y$$ 가 서로 독립일 때 $$E(XY) = E(X)E(Y)$$ (독립적인 확률변수의 곱에 대한 기댓값은 각 기댓값의 곱과 같다)

```
예시) 1등 상금이 1억원인 복권이 1장, 2등 상금이 100만원이 복권이 10장, 3등 상금이 1만원이 복권이 1000장 있다고 가정합시다. 이 복권의 총 판매량은 백만장입니다. 이 복권을 1장 샀을 때 기대할 수 있는 당첨 금액은 얼마일까요?
```

```
 Answer)
이때의 확률 변수를 X, 그에 대한 확률을 P(X)라고 할때, 이산확률분포는 다음 표와 같습니다.
기댓값 E는 모든 확률변수 X와 그에 대한 발생확률 P(X)를 곱한 다음, 모두를 더한 것과 같습니다. 따라서 다음과 같이 풀수 있습니다.
𝐸 = (100,000,000*1)/1,000,000 + (1,000,000*10)/1,000,000 + (10,000*1000)/1,000,000 + 0
= 100+10+10 = 120
여기서 말하는 기댓값 E=120의 의미는 복권 1장을 샀을 때 예상되는 당첨 금액이 120원이라는 뜻입니다.
```



* Mean :=Expectation Value

  * 평균의 정의(Definition of Mean)

    * 평균은 수학적으로 기댓값과 같은 의미이다.
    * 즉, '과거 6개월 간의 매출 평균이 다음달의 예상 매출액이 된다'는 확률의 관점에서 달리 표현하자면 '6개의 확률변수가 각각 같은 확률(1/6)로 발생하므로 다음 한달 동안의 매출에 대한 기댓값은 각 월의 매출에 1/6을 곱한 것을 모두 더한 합계와 같다'라고 하는 것

    $$
    N개의\ 확률변수가\ 각각 x_1,x_2,x_3,...,x_n이라는\ 값을\ 가질\ 때\ 평균\ 값은\ 다음과\ 같다. \\
    \bar{x} = \sum_{k=1}^n\frac{1}{n}\cdot x_k = \frac{1}{n}\sum_{k=1}^n x_k
    $$

```
Question) 그런데 과연 앞의 방식대로 평균값만 구하면 다음 달의 매출을 올바르게 예상할 수 있는 것인가?
```

```
Question) 그래서 단순히 평균값을 구하는 방법 외에도 평균값과 실 데이터가 얼마나 차이(Deviation, 편차)가 나는지에 대해 생각해 봅시다.
```



* 편차 vs 분산(Deviation vs Variance)

  * 편차의 문제
    * 매달 얼마만큼의 매출액이 고객별로 흩어져 있는지 분석했으나, 편차의 합계를 구해보면 0이 되어버린다.
    * (+) 방향과 (-) 방향으로 흩어진 매출의 차이가 상쇄되기 때문이다.
  * 따라서, 편차의 합으로는 매출의 흩어진 정도를 확인할 수 없다.

* 분산(Definition of Variance)

  * 어떻게 하면 상쇄되는 영향력을 없앨 수 있을까?
  * (+), (-) 부호를 없애기 위해 편차의 제곱을 이용하기로 한다.

  