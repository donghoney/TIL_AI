## Holistically-Nested Edge Detection 논문 번역



### Abstract

​	우리는 이 오랜 시력 문제에서 두 가지 중요한 문제를 해결하는 새로운 에지 감지 알고리즘을 개발했습니다. (1) 전체적인 이미지 훈련과 예측, (2) 다단계 및 다단계 기능 학습입니다. 제안된 방법인 전체론적 중첩 에지 감지(HED)는 완전한 경합 신경망과 심층 감시망을 활용하는 심층 학습 모델을 통해 이미지 투 이미지 예측을 수행합니다. HED는 에지 및 객체 경계 검출에서 어려운 모호성을 해결하기 위해 중요한 풍부한 계층적 표현(측면 반응의 심층 감독으로 유도됨)을 자동으로 학습합니다. NAT은 BSD500 데이터셋(ODS F 점수 0.782) 및 NYU 깊이 데이터셋(ODS F 점수 0.746)의 최신 기술을 대폭 향상시키고, 일부 최신 CNN 기반 에지 감지 알고리즘보다 훨씬 빠른 속도(영상당 0.4초)로 이를 구현합니다.



### 1. Instroduction

​	이 문서에서는 자연 영상에서 가장자리 및 객체 경계를 탐지하는 문제를 다룹니다. 이 문제는 시각적 쾌적성, 세분화, 물체 감지/인식, 추적 및 동작 분석, 의료 이미징, 구조별 이동 및 3D 재구성 등 전통적인 작업부터 자율 주행, 모바일 컴퓨팅과 같은 현대적 애플리케이션에 이르기까지 다양한 컴퓨터 비전 영역에 매우 중요하며 근본적인 영역입니다.g 및 image-totext 분석입니다. 자연 영상에서 가장자리를 정확하게 현지화하는 것은 다양한 "수준"에 대한 시각적 인식을 수반한다는 것은 오랫동안 이해되어 왔습니다 [18, 27]. 비교적 포괄적인 데이터 수집 및 인지 연구[28]를 보면, 각 피험자가 가장자리 및 경계를 배치할 위치에 대해 다소 다른 선호도를 가지고 있지만, 일관성 연구에서 F-점수 0.80을 달성하는 것과 같은 그럼에도 불구하고 피험자 사이에 인상적인 일관성이 있었습니다 [28]. 

​	컴퓨터 에지 탐지의 역사는 매우 풍부합니다. 우리는 이제 실용적으로 매우 중요한 것으로 입증된 몇 가지 대표작들을 강조합니다. 광범위하게 말하면, 작품을 몇 개의 그룹으로 분류할 수 있습니다. 예를 들어, I: 소벨 검출기 [20], 제로크로싱 [27, 37], 널리 채택된 캐니 검출기 [4]와 같은 초기 개척 방법, II: 특징 위에 대한 정보 이론이 통계 에지 [22], Pb [28], gPb [1]와 같은 신중한 수동 설계를 통해 도달했습니다. 그리고 III: BEL [5], Multi-scale [30], Sketch Tokens [24] 및 구조화된 에지 [6]와 같은 인간 디자인의 특징에 의존하고 있는 학습 기반 방법입니다. 또한, N4 -Fields [10], DeepContour [34], DeepEdge [2], CSCNN [19] 등, 자동 계층적 특징 학습의 중요성을 강조하는 Convolutional Neural Networks를 이용한 개발의 물결이 일고 있습니다. 딥러닝에서 이러한 폭발적인 발전을 하기 전에는 BSD500 데이터 세트에 대한 최신 성능[28](예: F-score .0746), 실질적으로 초당 2.5 프레임의 상당한 속도 덕분에 구조화된 에지 방식(일반적으로 약칭 SE)[6]이 가장 유명한 에지 감지 시스템 중 하나로 부상했습니다. 최근 CNN 기반 방법 [10, 34, 2, 19]은 SE에 비해 F-점수가 개선될 것으로 예상했습니다. 그러나 F 점수 및 속도 면에서 CNN 기반 방법을 개선할 여지가 여전히 큽니다. 현재 예측 범위는 몇 초[10]에서 몇 시간 [2](현대 GPU 사용 시에도)입니다. 

​	여기서는 전체론적 중첩 에지 감지(HED)라는 엔드 투 엔드 에지 감지 시스템을 개발하여 자연적 이미지 에지 및 객체 경계 검출에서 모호성을 해결하는 인간의 능력에 접근하기 위해 중요한 다양한 계층적 기능의 유형을 자동으로 학습합니다. HED는 구조화된 출력을 명시적으로 모델링하지 않았음에도 불구하고 이미지 투 이미지 방식으로 에지를 훈련하고 예측하는 것을 목표로 하기 때문에 "전체적"이라는 용어를 사용합니다. "중첩"을 사용하면 측점 출력으로 생성된 상속되고 점진적으로 정제된 에지 맵을 강조합니다. 각 예측이 이루어지는 경로가 이러한 에지 맵의 각 에지 맵에 공통적이며 연속 에지 맵이 보다 간결하다는 것을 보여 주려고 합니다. 이러한 계층적 기능의 통합 학습은 스케일 공간 가장자리 필드가 자동으로 학습되거나 계층적으로 연결되지 않는 이전의 다중 스케일 접근 방식 [40, 41, 30]과 구별됩니다. 

​	그림 1은 인간 대상 지면 진리 주석과 더불어 제안된 HED 에지 검출기(개별 레이어의 측면 반응 포함)의 결과 및 다양한 스케일 파라미터를 가진 캐니 에지 검출기 [4]의 결과를 예시합니다. 서로 다른 척도의 캐니 에지는 직접 연결되지 않을 뿐만 아니라 공간 이동과 불일치도 나타납니다. 제안된 전체론적 중첩 에지 검출기(HED)는 두 가지 중요한 문제를 다룹니다. (1) 전체론적 이미지 훈련 및 예측 [26], 이미지 대 이미지 분류(시스템은 이미지를 입력으로 삼고, 직접 에지 맵 이미지를 출력으로 생성함), 그리고 (2) 중첩된 다중 규모 기능 학습, 심층 감독을 수행하는 심층 감시망[23]에서 영감을 받아 초기 분류 결과를 "가이드"합니다. 우리는 이러한 기초 기법의 유리한 특성이 정확하고 계산적으로 효율적이라는 것을 발견하였습니다.



### 2. Holistically-Nested Edge Detection

​	이 섹션에서는 제안된 에지 감지 시스템의 공식화에 대해 자세히 설명합니다. 우리는 관련된 신경-네트워크 기반 접근법, 특히 다단계 및 다단계 특징 학습을 강조하는 접근법부터 논의합니다. 에지 및 객체 경계 검출 작업은 본질적으로 어려운 작업입니다. 수십 년의 연구 끝에, 중요하고 성공적인 시스템에서 역할을 할 가능성이 있는 여러 가지 특성이 나타났습니다. (1) 주의 깊게 설계 및/또는 학습된 특징 [28, 5], (2) 다단계 대응 융합 [40, 32, 30], (3) 다양한 시각 인식의 참여 [18, 27, 39, 17], 중간 수준의 게스탈트 법칙과 같은.웅변 [7], (4) 구조 정보(입력 데이터 및 출력 솔루션 내에서 전달되는 내적 상관 관계)와 컨텍스트(단거리 및 장거리 상호 작용 모두)를 통합한 [38],(5) 전체 이미지 예측(영상 내용을 전역적으로 직접 가져와 예측을 수행하는 접근 방식 참조), [25], (6) 활용합니다.en 3D 기하학 [15] 및 (7)이 폐쇄 경계를 처리합니다 [16]. 

​	구조화된 에지(SE) [6]는 주로 수동으로 설계된 많은 피쳐(property 1) 사용, 다중 스케일 반응 퓨전(property 2) 및 구조 정보 통합(property 4)의 세 가지 측면에 초점을 맞춥니다. 패치 기반 에지 예측을 위해 CNN을 사용한 최근 일련의 작업 [10, 34, 2, 19]에는 자동 기능 학습(property 1), 다중 규모 응답 퓨전(property 2), 서로 다른 수준의 시각적 인식(property 3)의 참여 가능성(property 3)의 세 가지 측면에 초점을 맞춘 대체 공통 스레드가 포함되어 있습니다. 그러나 (우리의 방법에 포함된) 깊은 감시가 부족하기 때문에 [2, 19]의 숨겨진 계층에서 생성된 다중 스케일의 반응은 피드백이 중간 계층을 통해 역선전되어야 하므로 의미가 적습니다. 더욱 중요한 것은, 패치와 픽셀 간 또는 패치 투 패치의 전략을 통해 교육 및 예측 효율성이 크게 저하된다는 것입니다. "전체적으로 중첩됨"을 통해, 우리는 엔드 투 엔드 에지 감지 시스템을 생산하고 있음을 강조하고자 합니다. 이는 완전한 경련 신경 네트워크[26]에서 영감을 얻었지만, 다듬어진 VGG 그물에 대한 추가적인 심층 감독을 통해 [36] (그림 3 참조). 심층 감시 및 측면 출력이 없는 경우, 에지 탐지가 매우 정확한 에지 픽셀 위치 지정을 요구하기 때문에, FCN(완전한 회선 네트워크)은 HED보다 만족도가 낮은 결과(예: BSD500의 F-score .745)를 생성합니다. 한 가지 언급할 가치가 있는 것은 우리의 이미지 투 이미지 교육 및 예측 전략은 여전히 상황별 정보를 명시적으로 포함하지 않는다는 것입니다. 왜냐하면 이웃 픽셀 라벨에 대한 제약은 HED에서 직접적으로 시행되지 않기 때문입니다. 패치 기반 CNN 에지 탐지 방법에 대한 속도 향상 외에도 성능 증가는 크게 세 가지 측면에 기인합니다. (1) FCN과 유사한 이미지 투 이미지 교육을 통해 상당히 많은 양의 샘플에 대해 동시에 교육할 수 있습니다(표 4 참조), (2) 모델에서의 심층 감독을 통해 보다 투명한 기능을 학습할 수 있습니다(참조).표 2); (3) 단대단 학습에서 측면 출력을 보간하면 각 계층의 일관성 있는 기여가 촉진됩니다(표 3 참조).



### 2.1 Existing multi-scale and multi-level NN

​	심층적인 신경 네트워크에서의 계층적 학습의 특성 때문에, 다단계 및 다단계 학습의 개념은 상황에 따라 다를 수 있습니다. 예를 들어, 다단계 학습은 점점 더 큰 수용성 필드 및 하향 샘플링(스트라이드) 층의 형태로 신경 네트워크 내부에 "내부"될 수 있습니다. 이 "내부"의 경우, 각 계층에서 학습되는 형상 표현들은 자연스럽게 다중 척도가 됩니다. 한편, 입력 이미지의 "척도를 비틀다"와 같이, 다단계 학습은 신경 네트워크의 "외부"가 될 수 있습니다. 이 두 변종들은 눈에 띄는 유사점을 가지고 있지만, 우리는 이 두 가지가 모두 다양한 작업에 적용되는 것을 보았습니다. 

​	다음으로 우리는 다중 규모 심층 학습의 가능한 구성을 4가지 범주로 공식화하여 계속합니다. 즉, 다중 스트림 학습, 건너뛰기 학습, 다중 입력에서 실행되는 단일 모델, 독립 네트워크의 교육. 그림 2에 그림이 나와 있습니다. 이러한 가능성을 염두에 두면 제안된 전체론적 중첩 네트워크 접근 방식이 이전의 노력과 다른 방식을 명확히 하고 표현 및 효율성 측면에서 중요한 이점을 강조하는 데 도움이 될 것입니다. 

​	**Multi-stream 학습** [3, 29] 일반적인 다중 스트림 학습 아키텍처는 그림 2(a)에 나와 있습니다. 다중(병렬) 네트워크 스트림은 여러 척도에 해당하는 파라미터 번호와 수용 가능한 필드 크기를 가집니다. 입력 데이터는 여러 스트림에 동시에 입력되며, 그 후 다양한 스트림에 의해 생성된 결합된 피쳐 응답이 글로벌 출력 계층으로 전송되어 최종 결과를 생성합니다. 

​	**Skip-layer 계층 네트워크** 학습: 이러한 형태의 네트워크에는 [26, 14, 2, 33, 10]이 있습니다. "스킵 레이어" 네트워크 학습의 핵심 개념은 그림 2(b)에 나와 있습니다. 여러 병렬 스트림을 교육하는 대신, 건너뛰기 네트워크 아키텍처의 토폴로지는 기본 스트림에 중심을 둡니다. 링크가 추가되어 기본 네트워크 스트림의 다양한 레벨의 기능 응답을 통합하고 이러한 응답은 공유 출력 계층에 결합됩니다.

 	위의 두 가지 설정에서 공통적인 점은 두 아키텍처 모두에서 단일 예측이 생성되는 하나의 출력 손실 기능만 있다는 것입니다. 그러나 에지 탐지에서는 에지 맵을 함께 결합할 수 있는 여러 예측을 얻는 것이 바람직하며 실제로 널리 사용되고 있습니다. 

​	**Single model on multiple inputs** : 다중 스케일 예측을 얻기 위해 그림 2(c)에서와 같이 다중(스케일링된) 입력 영상에서 단일 네트워크(또는 가중치를 가진 네트워크)를 실행할 수도 있습니다. 이 전략은 교육 단계(데이터 확대)와 테스트 단계("통합 테스트")에서 모두 수행할 수 있습니다. 한 가지 주목할 만한 예는 타이트 웨이트 피라미드 네트워크이다[8]. 이 접근법은 또한 심층적이지 않은 학습 기반 방법에서도 일반적입니다 [6]. 앙상블 테스트는 특히 더 심층적인 모델[2, 10]에서 학습 시스템의 예측 효율성을 저해합니다. 

​	**독립 네트워크(Independent networks)** 교육: 그림 2(a)의 극단적인 변형으로서, 깊이가 다르고 출력 손실 계층이 다른 여러 독립 네트워크를 교육하여 다중 스케일 예측을 하는 그림 2(d)를 추구할 수 있습니다. 이러한 복제는 교육에 필요한 리소스의 양을 배가하기 때문에 구현하는 것이 사실상 어려울 수 있습니다. 

​	**전체 중첩 네트워크(Holistically-nested networks)** : 그림 2(e)에 제시된 기존 접근 방식과 전체론적 중첩 네트워크 접근 방식을 명확하게 구분하기 위해 이러한 변형을 나열합니다. 기존 접근 방식에는 표현과 계산상의 복잡성 측면에서 상당한 중복성이 존재하는 경우가 많습니다. 제안된 전체론적 중첩 네트워크는 여러 척도에서 예측을 산출할 수 있는 비교적 단순한 변종입니다. 이 아키텍처는 그림 2(d)의 "독립 네트워크" 접근방식의 "전체적으로 중첩된" 버전으로 해석될 수 있으며, 이는 이름 선택에 동기를 부여합니다. 당사의 아키텍처는 여러 측면 출력이 있는 싱글리스림 딥 네트워크로 구성되어 있습니다. 이 아키텍처는 여러 이전 작품과 유사하며, 특히 저자들이 깊이 감시하는 넷[23] 접근 방식에서 숨겨진 계층 감시가 이미지 분류 작업의 최적화 및 일반화를 모두 개선할 수 있음을 보여줍니다. 또한 여러 측면 출력은 통합 출력이 필요한 경우 융접 계층을 추가할 수 있는 유연성을 제공합니다.



### 2.2 Formulation

​	여기서 가장자리 예측에 대한 접근 방식을 공식화합니다. 교육 단계 S = {(Xn, Yn), n = 1, . ., N}에 의해 설정된 입력 훈련 데이터를 나타냅니다. 여기서 샘플 Xn = {x(n) j, j = 1, ., |Xn|}은 원시 입력 이미지와 Yn = {y(n) j, ., ., |n(n)을 나타냅니다. 이후 각 이미지를 전체적으로 독립적으로 고려하므로 등록이 간단하다는 이유로 구독 n을 삭제합니다. 우리의 목표는 지상 진실에 접근하는 가장자리 맵을 제작할 수 있는 기능을 학습하는 네트워크를 갖는 것입니다. 단순성을 위해 모든 표준 네트워크 계층 매개변수의 집합을 W로 나타냅니다. 네트워크에 M 사이드 아웃풋 계층이 있다고 가정합니다. 또한 각 측면 출력 계층은 해당 가중치가 w = (w(1) , . , w(M) 로 표시되는 분류자와도 연결됩니다. 목표 함수 Lside(W, w) = X M m=1 αm"(m) 측(W, w(m))(1)을 고려합니다. 여기서 "side(side)는 sideoutputs(sideoutput)에 대한 영상 수준 손실 기능을 나타냅니다. 이미지 투 이미지 교육에서 손실 기능은 훈련 이미지 X = (xj, j = 1, ., |X|) 및 에지 지도 Y = (yj , j = 1, . ., |X|), yj ∈ {0, 1}의 모든 픽셀에 대해 계산됩니다. 일반적인 자연 영상의 경우 가장자리/비 에지 픽셀의 분포가 크게 편향되어 있습니다. 즉, 지면 진실의 90%가 가장자리가 아닙니다. 비용 민감 손실 기능은 [19]에서 제안되었으며, 편파 샘플링에 추가적인 트레이드오프 매개변수가 도입되었습니다. 대신 우리는 보다 간단한 전략을 사용하여 양수/음수 클래스 간의 손실을 자동으로 균형을 잡습니다. 픽셀 단위로 분류-균형화 중량 β를 소개합니다. Index j가 영상 X의 영상 공간 치수 위에 있습니다. 그런 다음 이 클래스 밸런싱 체중을 에지 및 비 에지 간의 불균형을 상쇄하는 간단한 방법으로 사용합니다. 구체적으로, 식 (1) " (m)측(W, w(m) ) = -β X j∈Y+ 로그 Pr(yj = 1|X;W, w(m) - (1 - β) X j∈Y- log Pr(yj = 0|X;W, w(m) β2)에 사용되는 다음과 같은 클래스 균형 교차 엔트로피 손실 함수를 정의합니다. Pr(yj = 1|X;W, w(m) ) = σ(a (m) j ) ∈ [0, 1]은 픽셀 j의 활성화 값에 sigmoid 함수 σ()를 사용하여 계산됩니다. 그런 다음 각 측 출력 계층에서 에지 지도 예측 Ym(m) 측 = σ(Aˆ(m) 측, 여기서 A≡(m) 측 {a(m) j, j = 1, |Y |}은(는) 계층 m의 측 출력 활성화입니다. 사이드 아웃풋 예측을 직접 활용하기 위해 네트워크에 "가중 퓨전" 레이어를 추가하고 (동시) 교육 중에 융합의 무게를 학습합니다. 융접층에서의 우리의 손실 기능은 Lfuse (W, w, h) = Dist(Y, Yˆ fuse) (3)이 됩니다. 여기서 Yˆ 퓨즈는 σ(PM m=1 hmAˆ (m))이고, 여기서 h = (h1, . ., hM)는 핵융합 중량입니다. Dist( ·, ·)는 융합 예측과 지상 진리 라벨 지도 사이의 거리이며, 교차 엔트로피 손실로 설정된다. 모든 것을 종합하여 표준(배경사) 확률적 경사 하강(W, w, h)을 통해 다음과 같은 객관적 기능을 최소화합니다.
? = argmin(Lside(W, w) + Lfuse(W, w, h) 자세한 하이퍼 파라미터 및 실험 설정은 섹션 4를 참조합니다. 테스트 단계 지정된 이미지 X에서 측면 출력 계층과 가중 퓨전 계층 모두에서 에지 맵 예측을 얻습니다. (Yˆ 퓨즈, Yˆ(1) 측, ., Yˆ(M) 측 ) = CNN(X, (W, w, h) ?), (5) 여기서 CNN(···)은 네트워크에서 생성된 에지 맵을 나타냅니다. 생성된 에지 맵을 추가로 집계하여 최종 통합 출력을 얻을 수 있습니다. 자세한 내용은 섹션 4에서 설명합니다. Yˆ HED = 평균(Yˆ 퓨즈, Yˆ (1) 측, . ., Yˆ (M) 측) (6)



### 3.3 Network Architecture

​	다음으로, 네트워크 아키텍처는 HED의 네트워크 아키텍처를 설명합니다. 



### 3.1. Trimmed Network for edge detection

​	프레임워크의 계층 선택은 생각할 가치가 있습니다. 아키텍처(1)가 깊이 있어야 지각적으로 다중 레벨 기능을 효율적으로 생성할 수 있고, (2) 서로 다른 단계를 가진 여러 단계를 통해 에지 맵의 고유한 척도를 캡처할 수 있습니다. 우리는 또한 처음부터 시작할 때 여러 단계로 이루어진 그러한 깊은 신경망을 훈련하는데 있어 잠재적인 어려움을 명심해야 합니다. 최근 VGGNet[36]은 ImageNet 과제에 있어 깊이(16개의 경량 레이어), 밀도(스트라이드-1 경량 커널) 및 여러 단계(2단계 다운샘플링 레이어 5개)로 최첨단 성능을 구현하는 것으로 확인되었습니다. 또한 최근 연구[2]에서는 일반 영상 분류 작업에서 사전 훈련된 심층 신경 네트워크를 미세하게 조정하는 것이 저수준 에지 감지 작업에도 유용하다는 것을 보여줍니다. 따라서 우리는 VGGNet 아키텍처를 채택하지만, (a) 각 단계의 마지막 경합 계층(각각 crap1 2, crap2 2, crap3 3, crap4 3, crap5 3)에 측면 출력 계층을 연결합니다. 이러한 각 회선형 계층의 수용 가능한 필드 크기는 해당 측면 출력 계층과 동일합니다. (b) 5번째 풀링 계층과 완전히 연결된 모든 계층을 포함하여 VGGNet의 마지막 단계를 절단했습니다. VGGNet을 "트라이밍"하는 이유는 두 가지입니다. 첫째, 척도가 서로 다른 의미 있는 측방향 출력을 예상하기 때문에, 32단계의 레이어는 너무 작은 출력 평면을 산출하며, 그 결과 보간 예측 맵이 너무 흐릿하여 활용할 수 없게 됩니다. 둘째, 완전히 연결된 레이어(볼루션으로 재귀하는 경우에도)는 계산적으로 집약적이므로, pool5에서 레이어를 자르면 교육 및 테스트 중에 메모리/시간 비용을 크게 줄일 수 있습니다. 최종 HED 네트워크 아키텍처는 각각 1, 2, 4, 8 및 16단계를 제공하며 수용 가능한 필드 크기가 서로 다른 5단계를 VGGNet에 내포되어 있습니다. 수용 필드 및 3.2단계의 구성에 대한 요약은 표 1을 참조합니다. 



### 3.2. Architecture alternatives

​	아래의 아키텍처 대안에서는 아키텍처 설계에서 가능한 몇 가지 대안, 특히 가장자리 감지 작업에 대한 HED의 심층적인 관리 역할에 대해 설명합니다. 



**FCN 및 Skip-layer 아키텍처**  FCN 모델에 사용되는 토폴로지는 HED 모델과 몇 가지 측면에서 다릅니다. 앞서 설명한 것처럼 FCN은 픽셀당 예측을 위해 분류망을 재해석하는 반면 출력 손실 기능은 하나만 있습니다. 따라서 FCN에서 건너뛰기 순 구조는 거친 상위 계층 정보와 미세한 하위 계층 정보를 결합하는 DAG이지만 다중 스케일 출력 예측을 명시적으로 생성하지는 않는다. 이 아키텍처를 HED 모델과 동일한 실험 환경에서 에지 탐지 태스크에 어떻게 사용할 수 있는지 알아봅니다. 먼저 손실 기능을 에지 감지를 위한 교차 엔트로피 손실로 교체하여 FCN-8s 모델을 직접 적용하려고 합니다. 표 2의 첫 번째 행에 나타난 결과는 만족스럽지 않습니다. 이 아키텍처는 여전히 충분하지 않기 때문에 기대됩니다. 또한 하위 계층의 링크를 더 추가하여 성능을 개선할 수 있는지 여부도 살펴봅니다. 그런 다음 풀1 및 풀2 계층에서 링크를 추가하는 FCN-2 네트워크를 생성합니다. 그러나 FCN 건너뛰기 네트워크 토폴로지를 직접 적용하는 것은 제안된 HED 아키텍처에 뒤쳐집니다(표 2의 두 번째 행 참조). FCN을 크게 수정하면 에지 감지 시 경쟁적 성능을 달성할 수 있지만, HED의 멀티스케일 사이드 아웃풋은 에지 감지를 위해 자연스럽고 직관적인 것으로 간주됩니다. 

**Deep supervision 역할**  각 측면 출력 계층을 연결하는 가중 퓨전 출력 계층을 통합하므로, 이제 전체 네트워크가 경로로 연결되어 있고, 가중 퓨전 계층 오류 전파에 의해 출력 계층 매개변수를 백프로포깅으로 업데이트할 수 있습니다.n 경로입니다(식 3에 따라 다름). 여기서는 원하는 에지 맵을 얻기 위해 심층적인 감독이 중요하다는 것을 보여줍니다. 제안된 네트워크의 주요 특징은 각 네트워크 계층이 특정 규모에서 에지 맵을 생성하는 역할을 담당하는 단일 네트워크로서 역할을 하도록 되어 있다는 것입니다. (1) 가중 퓨전 감독과 심층 감독을 모두 갖춘 훈련과 (2) 가중 퓨전 감독만을 포함한 훈련의 두 가지 변형에 기초한 정성적 결과가 여기에 있습니다. 우리는 깊은 감시를 통해 suc5 cessive edge map 예측치가 점차적으로 거칠고 미세하며, 국지적으로 글로벌하게 나타나는 것과 마찬가지로 내포된 측면 출력은 자연스럽고 직관적이라는 것을 관찰합니다. 반면, 가중 퓨전 출력 손실만 포함한 교육은 식별 가능한 순서가 결여된 에지 예측을 제공합니다. 즉, 상위 계층 측 출력에는 많은 중요 에지가 없습니다. 정확히 동일한 실험 설정에서 벤치마크 데이터 세트(표 2의 3열)의 결과는 F-점수에서 약간만 다를 뿐 심각한 색상을 보입니다.이 네트워크는 여러 척도에 걸쳐 직접적인 제어와 지침이 없는 표준화된 평균 정밀도입니다. 이 네트워크는 큰 구조 가장자리를 학습하는 데 크게 편중되어 있습니다.



### 4. Experiments

​	이 섹션에서는 자세한 구현에 대해 논의하고 제안된 알고리즘의 성능을 보고합니다. 

4.1. 구현 공개 가용 카페 라이브러리를 사용하여 프레임워크를 구현하고 FCN[26] 및 DSN[23]의 구현 위에 구축합니다. 따라서 상대적으로 엔지니어링 해킹이 거의 필요하지 않습니다. HED 시스템에서는 사전 교육을 받은 VGG-16 Net 모델을 사용하여 초기화를 통해 전체 네트워크를 세부적으로 조정합니다. 

**모델 매개변수**: CNN을 세부적으로 조정하여 영상 분류 또는 의미 분할을 수행하는 것과 달리, CNN을 저수준 에지 탐지를 수행하도록 조정하려면 각별한 주의가 필요합니다. 데이터 배포, 지상 진위 분배, 손실 기능의 차이는 모두 사전 훈련된 모델의 초기화와 함께라도 네트워크 융합에 어려움을 초래합니다. 먼저 검증 세트를 사용하고 [6]에서 사용하는 평가 전략을 따라 심층 모델 하이퍼 파라미터의 튜닝을 수행합니다. 하이퍼 파라미터(및 우리가 선택한 값)에는 미니 배치 크기(10), 학습 속도(1e-6) 각 사이드 아웃풋 레이어(1), 모멘텀(0.9), 중첩 필터의 초기화(0), 융접 레이어 중량 초기화(1/5), 체중 감소(0.0002), 교육 반복 횟수(10,000), 학습 속도를 10,000으로 나눕니다.r 5,000)입니다. 네트워크의 융합 동작에 초점을 맞춥니다. 교육이 수렴될 때마다 검증 세트의 F 점수 편차가 매우 작은 경향이 있음을 관찰합니다. 추가적인 비선형성을 포함시키는 것이 도움이 되는지를 조사하기 위해, 우리는 또한 각 측면 출력 계층 앞에 추가 계층(필터 50개 및 RLU 포함)을 추가하는 설정을 고려합니다. 우리는 이것이 성능을 악화시키는 것을 발견합니다. 또한 중첩된 다중 스케일 프레임워크가 입력 이미지 척도에 무감각하다는 것을 알 수 있습니다. 교육 과정 중에 GPU 메모리 사용을 줄이고 효율적인 배치 처리를 위해 모든 이미지를 400 × 400으로 크기를 조정하여 이를 활용합니다. 이어지는 실험에서, 우리는 HED의 가능한 변형의 이점을 알아보기 위해 위에서 설명한 모든 하이퍼 파라미터의 값을 수정합니다. 

**컨센서스 샘플링** 우리의 접근법에서, 우리는 각 측면 출력 계층에서 접지 진위를 복제하고 (다운 샘플링된) 측 출력 크기를 원래 크기로 조정합니다. 따라서 높은 수준의 측면 출력에 불일치가 존재합니다. 즉, 가장자리 예측은 거칠고 전지구적인 반면, 지면 진리는 여전히 노이즈로 간주될 수 있는 약한 가장자리를 많이 포함하고 있습니다. 이 문제는 사전 교육을 받은 모델의 도움을 받아도 문제가 있는 융합 행위로 이어집니다. 이러한 불일치로 인해 높은 수준의 사이드 아웃풋 레이어에서 폭발하는 백프로그래밍된 그라데이션이 발생하는 것으로 관찰됩니다. 따라서 BSDS 데이터 세트의 접지 진실 레이블을 사용하는 방법을 조정하여 이 문제를 해결합니다. 특히 지상 진리 라벨은 여러 주석자에 의해 제공되므로 암묵적으로 더 큰 레이블러 합의는 더 강한 지상 진리 가장자리를 나타냅니다. 우리는 비교적 강력한 솔루션을 채택합니다. 즉, 최소 3개의 주석자에 의해 양으로 표시된 픽셀만 양의 레이블로 지정하면 됩니다. 다른 모든 레이블의 픽셀은 음성으로 간주합니다. 이를 통해 높은 수준의 사이드 아웃풋 레이어에서 발생하는 그라데이션 폭발 문제를 해결할 수 있습니다. 낮은 수준의 계층의 경우, 이러한 합의 접근 방식은 에지 분류에 대한 견고성을 추가로 가져오고 네트워크가 약한 에지에 의해 산만해지는 것을 방지합니다. 본 논문에서 완전히 탐구되지는 않았지만, 합의된 수준의 진실 에지를 신중하게 다루면 더욱 개선될 수 있습니다.데이터 증강 데이터 확대는 심층 네트워크에서 중요한 기술임이 입증되었습니다. 이미지를 16개의 다른 각도로 회전하고 회전된 이미지에서 가장 큰 사각형을 자릅니다. 또한 각 각도로 영상을 플립하여 확대된 교육 세트로 이어집니다. 이 교육 세트는 구성되지 않은 이미지보다 32배 더 큽니다. 테스트하는 동안 우리는 원래 크기의 입력 이미지에서 작업합니다. 또한 "합성 시험"(회전/플립된 영상에 대한 예측을 하고 예측을 평균화)은 F-점수와 평균 정밀도를 향상시키지 않습니다. 다른 풀링 기능 이전 작업[2]에서는 서로 다른 풀링 기능이 에지 감지 결과에 큰 영향을 미칠 수 있음을 시사합니다. 모든 풀링 레이어가 평균 풀링으로 대체되는 제어된 실험을 실시합니다. 평균 풀링을 사용하면 ODS=.741로 성능이 저하됩니다. 네트워크 내 이선 보간 예측 상향 샘플링은 [26]과 유사한 네트워크 내 디콘볼루션 레이어로 구현됩니다. 모든 디콘볼루션 레이어를 고정하여 선형 보간 작업을 수행합니다. [26]에서 임의의 보간 기능을 배울 수 있다는 것이 지적되었지만, 학습된 디콘볼루션은 실험에서 눈에 띄는 개선점을 제공하지 않는다는 것을 알게 되었습니다. 단일 NVIDIA K40 GPU에서 실행 시간 교육은 약 7시간이 소요됩니다. 320 × 480 이미지의 경우 HED 400ms가 소요되며, 최종 에지 맵(인터페이스 오버헤드 포함)은 기존 CNN 기반 방법보다 상당히 빠릅니다 [34, 2]. 또한 일부 이전 에지 감지기는 효율성의 저하라는 바람직하지 않은 편법으로 성능을 향상시키려고 합니다(예: 여러 척도에서 입력 이미지를 테스트하고 리6 결과를 평균화).